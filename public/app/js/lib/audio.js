define(["queue","castrato","templates"],function(n,o,e){var t=!1,i=!0,u=!1,a=function(o,e){if(e=void 0===e?0:e,t&&i&&e<Object.keys(o).length&&!u){var d=o[e],c=d[0],f=d[1],s=d[2],l=t.createOscillator(),w=t.createGain();l.frequency.value=c,l.connect(w),w.gain.value=.25,w.connect(t.destination),n.add_function_delayed(f,function(){l.noteOn?l.noteOn(0):l.start(0)}),n.add_function_delayed(f+s,function(){l.noteOff?l.noteOff(0):l.stop(0)}),++e<Object.keys(o).length?a(o,e):n.run()}},d=function(){i=!0},c=function(){i=!1},f=function(){u=!0,o.emit("console:info",e.messages.muted)},s=function(){u=!1,o.emit("console:info",e.messages.unmuted)};(window.AudioContext||window.webkitAudioContext)&&(t=new(window.AudioContext||window.webkitAudioContext)),o.on("audio:play",function(n){a(n)}),o.on("audio:on",d),o.on("audio:off",c),o.on("audio:mute",f),o.on("audio:unmute",s)});